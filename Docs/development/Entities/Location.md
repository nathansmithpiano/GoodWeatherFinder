# Location

Each `Location` is determined by a precise set of GPS coordinates (latitude and longitude).

> ### Development
> I began by listing data that may be relevant to a mountain summit.  Then, in the name of normalization, I reorganized that data into other entities.  `Location` and its other entities will all have their own tables in the database.

### Mount Elbert

Mount Elbert is the highest peak in Colorado and a popular, well-known destination.  As the initial database contains Colorado peaks above 13,000 and 14,000 feet, I have chosen this location as the example for this documentation.

## Location Entity

> **Legend:
> ** **PK** = Primary Key | **FK** = Foreign Key | **NN** = Non Null | **AI** = Auto Incremented | **UQ** = Unique | **UN** = Unsigned

<table>
    <tr>
        <th>Property</th>
        <th>Type</th>
        <th>Characteristics</th>
        <th>Value</th>
        <th>Mapping</th>
    </tr>
    <tr>
        <td><a href="#locationid">id</a></td>
        <td><code>int</code></td>
        <td>PK, NN, AI, UQ, UN, required</td>
        <td>generated</td>
        <td></td>
    </tr>
    <tr>
        <td><a href="#locationname_id">name<br>(name_id)</a></td>
        <td><code>Name</code></td>
        <td>FK, NN, UQ, UN, required</td>
        <td>
            `Name`
            <br>
            `int`
        </td>
        <td>
            <code>Location</code>
            <code>1:1</code>
            <code>Name</code>
            <br>
            <code>location.name_id</code>
            <code>int</code>
        </td>
    </tr>
    <tr>
        <td><a href="#locationelevation">elevation</a></td>
        <td><code>Double</code></td>
        <td>UN, optional</td>
        <td>4389.12</td>
        <td></td>
    </tr>
    <tr>
        <td><a href="#locationothernames">otherNames</a></td>
        <td>List<<code>Name</code>></td>
        <td>optional</td>
        <td>
            <code>Name</code>, ...
            <br>
            <code>Name</code>
        </td>
        <td>
            <code>Location></code>
            <code>m:m></code>
            <code>Name></code>
            <br>
            <code>join table</code>
        </td>
    </tr>
    <tr>
        <td><a href="#locationgeometry_id">geometry<br>(geometry_id)</a></td>
        <td><code>Geometry</code></td>
        <td>FK, NN, UN, required</td>
        <td><code>Geometry</code></td>
        <td>
            <code>Location</code>
            <code>m:1</code>
            <code>Geometry</code>
            <br>
            <code>location.geometry_id</code>
            <code>int</code>
        </td>
    </tr>
    <tr>
        <td><a href="#locationcategories">categories</a></td>
        <td>List<<code>Category</code>></td>
        <td>optional</td>
        <td>
            <code>Category</code>, ...
            <br>
            <code>Category</code>
        </td>
        <td>
            <code>Location</code>
            <code>m:m</code>
            <code>Category</code>
            <br>
            <code>join table</code>
        </td>
    </tr>
    <tr>
        <td><a href="#locationactivities">activities</a></td>
        <td>List<<code>Activity</code>></td>
        <td>optional</td>
        <td>
            <code>Activity</code>, ...
            <br>
            <code>Activity</code>
        </td>
        <td>
            <code>Location</code>
            <code>m:m</code>
            <code>Activity</code>
            <br>
            <code>join table</code>
        </td>
    </tr>
    <tr>
        <td><a href="#locationregions">regions</a></td>
        <td>List<<code>Region</code>></td>
        <td>optional</td>
        <td>
            <code>Region</code>, ...
            <br>
            <code>Region</code>
        </td>
        <td>
            <code>Location</code>
            <code>m:m</code>
            <code>Region</code>
            <br>
            <code>join table</code>
        </td>
    </tr>
</table>

## <a href="#location-entity">location.id</a><small>
üí° Click on the blue headers to return to the Entity table
- Primary Key for `Location`. Automatically generated by the database.  
- Non-null, auto-increment, unique, unsigned, and required.

## <a href="#location-entity">location.name_id</a>
- Name for this location.
- `@JoinColumn` via location.name_id.
- Stored within `Location` as a `Name` entity.
- Each location has one primary name.  This primary name is unique for all Locations.
    - For this primary name, `Location` `1:1` `Name`.
- Non-null, unique, and required.

<table>
<tr>
    <!-- Top row headers -->
    <th colspan="2">Location</th>
    <th>Join Table</th>
</tr>
<tr>
<!-- Location Code -->
<td>

```java
public class Location {
    private int id;

    @OneToOne
    @JoinColumn(name = "name_id")
    private Name name;
}
```

</td>
<!-- Location table -->
<td>
    <table>
        <tr>        
            <th>id</th>
            <th>name_id</th>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
        </tr>
    </table>
</td>
<!-- Join Table -->
<td rowspan="3">
    <table>
        <tr>        
            <th>location_id</th>
            <th>name_id</th>
        </tr>
        <tr>
            <td>1</td>
            <td>3</td>
        </tr>
        <tr>
            <td>1</td>
            <td>4</td>
        </tr>
        <tr>
            <td>1</td>
            <td>5</td>
        </tr>
    </table>
<!-- Join Table message -->
‚ùó There should be no record for  
`Location.name` (primary name)  
in the join table
</td>
</tr>
<tr>
    <!-- Names Header -->
    <th colspan="2">Names</th>
</tr>
<tr>
<!-- Name Code -->
<td>

```java
public class Name {
    private int id;
    private String name;
}
```

</td>
<!-- Names Table -->
<td>
    <table>
        <tr>        
            <th>id</th>
            <th>name</th>
        </tr>
        <tr>
            <td>2</td>
            <td>Mount Elbert</td>
        </tr>
    </table>
</td>
</tr>
</table>

## <a href="#location-entity">location.elevation</a>
- Elevation for this location, in meters.
- Optional - relevant for some locations but not others.
    - i.e. elevation is important for a mountain summit but not for a beach

<table>
<!-- Header -->
<tr>
    <th colspan="2">Location</th>
</tr>
<tr>
<!-- Location Code -->
<td>

```java
public class Location {
    private int id;
    private Double elevation;
}
```

</td>
<!-- Location Table -->
<td>
    <table>
        <tr>        
            <th>id</th>
            <th>elevation</th>
        </tr>
        <tr>
            <td>1</td>
            <td>4389.12</td>
        </tr>
    </table>
</td>
</tr>
</table>

## <a href="#location-entity">location.otherNames</a>
- Additional names for this location.
    - For example, Mount Elbert is also known as Mt. Elbert. It may also have a traditional name, names in other languages, nicknames, etc.
    - `Location.name_id` corresponds to its primary name.  The join table links a `Location` with its `otherNames`.
        - - [ ] Use business logic to prevent a user from setting a `Name` as its `Location.name` and within its `List<Name> otherNames`.
- While primary name must be unique, other names are not.  Many `Location` may share the same `Name` in their `List<Name> otherNames`.
    - For example, several `Location` may be called "Buffalo Mountain", but each `Location` would have a unique primary name of "Buffalo Mountain A", "Buffalo Mountain (CO)", etc.  
    - If "Buffalo Mountain A" was deleted, we do not want all "Buffalo Mountain" records in the `Names` table to be deleted from the database.
    - If no records exist in the join table connecting a `Location` with "Buffalo Mountain", within `Name.name`, "Buffalo Mountain" should be deleted.
        - This seems possible via `orphanRemoval = true` on the `Location` side
            - - [ ] confirm via JUnit5 tests
    - Therefore, the database would have several copies of the "Buffalo Mountain" `Name`.
- For `Location.otherNames`, `Location` `1:m` `Name`.
- A `m:m` relationship between `Location` and `Name` would allow for proper normalization and would prevent duplicates, but this would require manual deleting and seems excessive for this application.
    - Also, other entities, such as `Region`, may also use the `Names` table for a collection of names.
- Optional - a location may only have one name and `List<Name> otherNames` may be empty

<table>
<tr>
    <!-- Top row headers -->
    <th colspan="2">Location</th>
    <th>Join Table</th>
</tr>
<tr>
<!-- Location Code -->
<td>

```java
public class Location {
    private int id;
    private List<Name> otherNames;
}
```

</td>
<!-- Location Table -->
<td>
    <table>
        <tr>        
            <th>id</th>
            <th>name_id</th>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
        </tr>
    </table>
</td>
<!-- Join Table -->
<td rowspan="3">
    <table>
        <tr>        
            <th>location_id</th>
            <th>name_id</th>
        </tr>
        <tr>
            <td>1</td>
            <td>3</td>
        </tr>
        <tr>
            <td>1</td>
            <td>4</td>
        </tr>
        <tr>
            <td>1</td>
            <td>5</td>
        </tr>
    </table>
</td>
<!-- Names Header -->
<tr>
    <th colspan="2">Names</th>
</tr>
<tr>
<!-- Name Code -->
<td>

```java
public class Name {
    private int id;
    private String name;
}
```

</td>
<!-- Names Table -->
<td>
    <table>
        <tr>        
            <th>id</th>
            <th>name</th>
        </tr>
        <tr>
            <td>2</td>
            <td>Mount Elbert</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Mt. Elbert</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Other Nickname</td>
        </tr>
        <tr>
            <td>5</td>
            <td>Traditional name</td>
        </tr>
    </table>
</td>
</tr>
</table>

## <a href="#location-entity">location.geometry_id</a>
- Foreign key for this location's geometry.
- `@JoinColumn` via location.geometry_id.
- `Geometry` contains a coordinateList, which for a `Location` contains 1 and only 1 `Coordinates`.
    - For `Geometry` and `Coordinate`, `@JoinColumn` via `coordinates.geometry_id`.
- `Geometry` `1:1` `Coordinates`.
- Special considerations:
    - `Location` cannot obtain any weather data without `Coordinates`, so `location.geometry_id` is required.
    - No two locations should share the same coordinates, so for `location.geometry_id` should be unique.
    - Users could attempt to add a `Location` with `Coordinates` lacking precision, i.e. 39, -106. Before submitting a new location, it is necessary to confirm the `Coordinates` are unique and to re-prompt.
        - When submitting a location, a map could appear to confirm the location, and a user could drag the point to correct precision.  From the map, more precise `Coordinates` could be obtained.
- Non-null, unique, and required.

<table>
<tr>
    <th colspan="2">Location</th>
</tr>
<tr>
<td>

```java
public class Location {
    @OneToOne
    @JoinColumn(name = "geometry_id")
    private Geometry geometry;
}
```

</td>
<td>
    <table>
        <tr>
            <th>id</th>
            <th>geometry_id</th>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
        </tr>
    </table>
</td>
</tr>

<tr>
    <th colspan="2">Geometry</th>
</tr>
<tr>
<td>

```java
public class Geometry {
    @OneToMany(mappedBy = "geometry")
    private List<Coordinates> coordinates;
}
```

</td>
<td>
    <table>
        <tr>
            <th>id</th>
            <th>Type</th>
        </tr>
        <tr>
            <td>2</td>
            <td>Point</td>
        </tr>
    </table>
</td>
</tr>

<tr>
    <th colspan="2">Coordinates</th>
</tr>
<tr>
<td>

```java
public class Coordinates {
    @ManyToOne
    @JoinColumn(name = "geometry_id")
    private Geometry geometry;
}
```

</td>
<td>
    <table>
        <tr>
            <th>id</th>
            <th>geometry_id</th>
            <th>Latitude</th>
            <th>Longitude</th>
        </tr>
        <tr>   
            <td>3</td>
            <td>2</td>
            <td>39.118075</td>
            <td>-106.445417</td>
        </tr>
    </table>
</td>
</tr>
</table>


## <a href="#location-entity">location.categories</a>


<table>
    <tr>
        <th colspan="2">Location</th>
        <th>Join Table</th>
    </tr>
    <tr>
<td>

```java
public class Location {

}
```

</td>
        <td>
            <table>
                <tr>
                    <th>id</th>
                </tr>
                <tr>
                    <td>1</td>
                </tr>
            </table>
        </td>
        <td rowspan="3">
            <table>
                <tr>
                    <th>location_id</th>
                    <th>category_id</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>4</td>
                </tr>
            </table>
        </td>
    </tr>

<tr>
    <th colspan="2">Category</th>
</tr>
<tr>
<td>

```java
public class Category {

}
```

</td>
<td>
    <table>
        <tr>
            <th>id</th>
            <th>Name</th>
        </tr>
        <tr>
            <td>2</td>
            <td>Mountain</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Summit</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Colorado 14er</td>
        </tr>
    </table>
</td>
</tr>
</table>

## <a href="#location-entity">location.activities</a>


<table>
    <tr>
        <th colspan="2">Location</th>
        <th>Join Table</th>
    </tr>
    <tr>
<td>

```java
public class Location {

}
```

</td>
        <td>
            <table>
                <tr>
                    <th>id</th>
                </tr>
                <tr>
                    <td>1</td>
                </tr>
            </table>
        </td>
        <td rowspan="3">
            <table>
                <tr>
                    <th>location_id</th>
                    <th>activity_id</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>4</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>6</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>7</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>8</td>
                </tr>
            </table>
        </td>
    </tr>

<tr>
    <th colspan="2">Activity</th>
</tr>
<tr>
<td>

```java
public class Activity {

}
```

</td>
<td>
    <table>
        <tr>
            <th>id</th>
            <th>Name</th>
        </tr>
        <tr>
            <td>2</td>
            <td>Hiking</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Climbing</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Mountaineering</td>
        </tr>
        <tr>
            <td>5</td>
            <td>Trail Running</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Camping</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Backpacking</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Skiing/Snowboarding (Backcountry)</td>
        </tr>
    </table>
</td>
</tr>
</table>

## <a href="#location-entity">location.regions</a>

<table>
    <tr><th>Region</th></tr>
    <tr>
        <td>
            <table>
                <tr>
                    <th>id</th>
                    <th>parent_id</th>
                    <th>Type</th>
                    <th>Name</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>null</td>
                    <td>Mountain Range</td>
                    <td>Rocky Mountains</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>1</td>
                    <td>Mountain Range</td>
                    <td>Southern Rocky Mountains</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>2</td>
                    <td>Mountain Range</td>
                    <td>Sawatch</td>
                </tr>
                <tr>
                    <td><b>4</b></td>
                    <td><b>3</b></td>
                    <td><b>Mountain Range</b></td>
                    <td><b>Elbert Massif</b></td>
                </tr>
                <tr>
                    <td><b>5</b></td>
                    <td><b>null</b></td>
                    <td><b>National Forest</b></td>
                    <td><b>San Isabel National Forest</b></td>
                </tr>
            </table>
        </td>
    </tr>
</table>

## <a href="#location-entity">location.typeList</a>

REDO THIS with generic entity `Type` that holds additional information

THINK
- River
- Lake
- Beach
- Stadium/Arena
- Ski Resort
- Golf Course
- Park
- Pool
- Concert/Venue


<table>
    <tr><th>Mountain</th></tr>
    <tr>
        <td>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Abbreviation</th>
                    <th>Elevation</th>
                    <th><code>Region</code></th>
                </tr>
                <tr>
                    <td>Mount Elbert</td>
                    <td>Mt. Elbert</td>
                    <td>4389.12</td>
                    <td><code>Region</code></td>
                </tr>
            </table>
        </td>
    </tr>
</table>

#### TEMPLATE
<table>
    <tr>
        <th></th>
        <th></th>
    </tr>
    <tr>
        <td></td>
        <td></td>
    </tr>
</table>
